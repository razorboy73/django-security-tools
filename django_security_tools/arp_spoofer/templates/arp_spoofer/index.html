{% extends "base.html" %}

{% block title %}ARP Spoofer{% endblock %}

{% block content %}
<div class="container">
    <h1>ARP Spoofer</h1>
    <p>
        ARP spoofing is a technique by which an attacker sends fake Address Resolution Protocol (ARP) messages
        onto a local area network. This is often done to link the attackerâ€™s MAC address with the IP address
        of a legitimate computer or server on the network, enabling the attacker to intercept, modify, or block data.
    </p>
    <p>
        This application demonstrates ARP spoofing for educational and security testing purposes only.
        Unauthorized use is strictly prohibited.
    </p>

    <!-- Detect Gateway Section -->
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="detect_gateway" class="btn btn-primary">Detect Gateway</button>
    </form>

    {% if gateway_info %}
        {% if gateway_info.error %}
            <div class="alert alert-danger mt-3">
                <strong>Error:</strong> {{ gateway_info.error }}
            </div>
        {% else %}
            <div class="alert alert-success mt-3" id="gateway-info">
                <h4>Gateway Information</h4>
                <p><strong>IP Address:</strong> {{ gateway_info.ip }}</p>
                <p><strong>MAC Address:</strong> {{ gateway_info.mac }}</p>
            </div>
        {% endif %}
    {% endif %}

    <!-- Scan Network Section -->
    {% if gateway_info and not gateway_info.error %}
        <form method="post" class="mt-3">
            {% csrf_token %}
            <button type="submit" name="scan_network" class="btn btn-secondary">Scan Network</button>
        </form>
    {% endif %}

    <!-- Network Scan Results -->
    {% if scan_results %}
        <div class="alert alert-success mt-3" id="scan-results">
            <h4>Network Scan Results</h4>
            <ul class="list-group">
                {% for device in scan_results %}
                    <li class="list-group-item">
                        <strong>IP:</strong> {{ device.ip }} | <strong>MAC:</strong> {{ device.mac }}
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <!-- Error Messages -->
    {% if error %}
        <div class="alert alert-danger mt-3">
            <strong>Error:</strong> {{ error }}
        </div>
    {% endif %}
</div>
{% endblock %}
