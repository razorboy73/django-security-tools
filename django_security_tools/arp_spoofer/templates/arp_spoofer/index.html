{% extends "base.html" %}

{% block title %}ARP Spoofer{% endblock %}

{% block content %}
<div class="container">
    <h1>ARP Spoofer</h1>
    <p>
        ARP spoofing is a technique by which an attacker sends fake Address Resolution Protocol (ARP) messages
        onto a local area network. This is often done to link the attackerâ€™s MAC address with the IP address
        of a legitimate computer or server on the network, enabling the attacker to intercept, modify, or block data.
    </p>
    <p>
        This application demonstrates ARP spoofing for educational and security testing purposes only.
        Unauthorized use is strictly prohibited.
    </p>

    <!-- Messages Section -->
    {% for message in messages %}
        <div class="alert {% if message.tags == 'success' %}alert-success{% else %}alert-danger{% endif %}">
            {{ message }}
        </div>
    {% endfor %}

    <!-- Detect Gateway -->
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="detect_gateway" class="btn btn-primary">Detect Gateway</button>
    </form>

    {% if gateway_info %}
        <div class="alert alert-info mt-3">
            <h4>Gateway Information</h4>
            <p><strong>IP Address:</strong> {{ gateway_info.ip }}</p>
            <p><strong>MAC Address:</strong> {{ gateway_info.mac }}</p>
        </div>
    {% endif %}

    <!-- Scan Network -->
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="scan_network" class="btn btn-secondary">Scan Network</button>
    </form>

    {% if scan_results %}
        <div class="mt-3">
            <h4>Network Scan Results</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>IP Address</th>
                        <th>MAC Address</th>
                    </tr>
                </thead>
                <tbody>
                    {% for device in scan_results %}
                        <tr>
                            <td>{{ device.ip }}</td>
                            <td>{{ device.mac }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Select Target for Spoofing -->
        <form method="post" class="mt-3">
            {% csrf_token %}
            <div class="form-group">
                <label for="target">Select Target for Spoofing:</label>
                <select name="target" id="target" class="form-select" required>
                    {% for device in scan_results %}
                        <option value="{{ device.ip }}|{{ device.mac }}">{{ device.ip }} - {{ device.mac }}</option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit" name="spoof_target" class="btn btn-danger mt-2">Start Spoofing</button>
        </form>
    {% endif %}
</div>
{% endblock %}
